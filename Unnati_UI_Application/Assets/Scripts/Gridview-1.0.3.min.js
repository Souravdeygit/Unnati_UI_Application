/****************************
 * Title - Dynamically Table Bind
 * Description - Bind table with JSON value
 * Author - Jayanta Rakshit
 * Copyright - (c) 2018
 * Version - 1.0.3
 * Licence - Nil
 ****************************/
!function(t){var e=function(e,n,i){this.obj=t(e),this.isTable=this.obj.is("table"),this.table=this.isTable?t(e):t(a.table),this.tableHeadDataExists=!!this.table.children("thead").children("tr").children("th").length,this.isAutoColumn=!("autocolumn"in i)||i.autocolumn,this.isRowMerge="rowmerge"in i&&i.rowmerge,this.ExtraColumn="column"in i?i.column:[],this.Columns=("object"!=typeof n||this.isTable,this.getColumnNameList(n,i)),this.thead=this.isTable?this.tableHead(this.table.children("thead")):this.tableHead(a.head),this.tbody=this.isTable?this.tableBodyGenerate(this.table.children("tbody"),n,i):this.tableBodyGenerate(a.body,n,i),this.tfoot=this.isTable?this.table.children("tfoot"):"",this.show(i)};e.prototype={getColumnNameList:function(e,a){var n=[],i=a.column;return null!==e&&(this.isAutoColumn?(n=Object.keys(e[0]),Object.keys(a.column).length&&t.each(i,function(t,e){var a="name"in e?e.name:"",i="place"in e?e.place:"";if("last"===i.toLowerCase().trim())n.length&&n.push(a);else if("first"===i.toLowerCase().trim()){if(n.length){var r=n;n=[];for(var h=-1;h<r.length;h++)h>=0?n.push(r[h]):n.push(a)}}else n.length&&n.push(a)})):(n=[],t.each(i,function(t,e){var a="name"in e?e.name:"";n.push(a)}))),n},tableHeadGenerate:function(e){if(this.Columns.length){var a=t(e),n=t("<tr></tr>");t(this.Columns).each(function(e,a){var i=t("<th></th>");i.html(a),n.append(i)}),a.append(n)}return a},tableHead:function(e){if(this.isTable){var n=t(e).length>0?t(e):t(a.head);if(n.length>0){var i=null;if(n.children("tr").length>0&&(i=n.children("tr")),null===i)return this.tableHeadGenerate(n);var r=this.Columns;return n.empty(),t(i).each(function(e,a){var i=t(this);t(r).each(function(e,a){var n=t("<th></th>").text(a);i.append(n)}),n.append(i)}),n}return this.tableHeadGenerate(n)}return this.tableHeadGenerate(e)},tableBodyGenerate:function(e,n,i){var r=t(e).length>0?t(e):t(a.body),h=this.ExtraColumn,l=this.isAutoColumn;this.isTable&&r.empty();var o=this.Columns;return t.each(n,function(e,a){var n=t("<tr></tr>");l?t.each(o,function(e,i){var r=t("<td></td>");a[i]?r.html(a[i]):t.each(h,function(e,n){var h="name"in n?n.name:"",l="value"in n?n.value:"",o="dbcol"in n?a[n.dbcol]:"",s="data"in i?i.data:{};if(h.toLowerCase().trim()===i.toLowerCase().trim()){var d=t(l);if(d.isFormTag())d.val(o),r.html(d);else if(d.isAnchorTag()){var u="";if(d.hasAttr("href")&&(u=d.attr("href")).length>window.location.origin.length){var c=u.indexesOf("{"),f=u.indexesOf("}"),b=[];if(c.length!==f.length)throw"'href' value shoud be valid format";for(var m=0;m<c.length;m++){var g=c[m],v=f[m];g>0&&v>0&&b.push(u.slice(g+1,v).trim())}if(b.length>0){for(m=0;m<b.length;m++){var p=new RegExp("{"+b[m]+"}","g");u=u.replace(p,a[b[m]])}d.attr("href",u)}else d.attr("href",u);var w=Object.keys(s);w.length>0&&t.each(w,function(t,e){d.attr("data-"+e,a[s[e]])})}r.html(d)}else if(d.isHtmlTag()){u="";t.each(d,function(){var e=t(this);o.length>0&&e.html(o);var n=Object.keys(s);n.length>0&&t.each(n,function(t,n){e.attr("data-"+n,a[s[n]])})}),r.html(d)}else r.html(o)}}),n.append(r)}):t.each(h,function(e,i){var r=t("<td></td>"),h=("name"in i&&i.name,"value"in i?i.value:""),l="dbcol"in i?a[i.dbcol]:"",o="data"in i?i.data:{},s=t(h);if(s.isFormTag()){var d=Object.keys(o);d.length>0&&t.each(d,function(t,e){s.attr("data-"+e,a[o[e]])}),s.val(l),r.html(s)}else if(s.isAnchorTag()){t.each(s,function(){var e=t(this);if(e.hasAttr("href")){if((c=e.attr("href")).length>window.location.origin.length){var n=c.indexesOf("{"),i=c.indexesOf("}"),r=[];if(n.length!==i.length)throw"'href' value shoud be valid format";for(var h=0;h<n.length;h++){var l=n[h],d=i[h];l>0&&d>0&&r.push(c.slice(l+1,d).trim())}if(r.length>0){for(h=0;h<r.length;h++)var u=new RegExp("{"+r[h]+"}","g"),c=c.replace(u,a[r[h]]);e.attr("href",c)}else e.attr("href",c)}var f=Object.keys(o);f.length>0&&t.each(f,function(t,e){s.attr("data-"+e,a[o[e]])})}}),r.html(s)}else if(s.isHtmlTag()){t.each(s,function(){var e=t(this);l.length>0&&e.html(l);var n=Object.keys(o);n.length>0&&t.each(n,function(t,n){e.attr("data-"+n,a[o[n]])})}),r.html(s)}else r.html(l);n.append(r)}),i.onrowbound(n),i.onrowbound(e,n),r.append(n)}),r},show:function(e){var a=this.isTable?this.table:t("<table></table>");e.id=this.isTable?this.table.attr("id"):e.id,a.addClass(e.class),a.attr("id",e.id),a.append(this.thead),a.append(this.tbody),a.append(this.tfoot),this.isRowMerge&&this.rowMerge(),this.isTable||this.obj.html(a)},rowMerge:function(e){var a=this.tbody.children("tr");for(index=a.length-2;index>=0;index--){var n=a.eq(index+1),r=a.eq(index),h=n.children("td"),l=r.children("td");for(i=0;i<l.length;i++){var o=t(h[i]),s=t(l[i]);if(s.text().replace(/\ /g,"")===o.text().replace(/\ /g,"")){var d=t(o).hasAttr("rowspan")?o.attr("rowspan"):1;d=parseInt(d)+1,s.attr("rowspan",d),o.remove()}}}}},t.fn.Gridview=function(t,a){return this.each(function(){new e(this,t,new n(a))})},t.fn.Gridview.Constructor=e,t.fn.Gridview.Default={},t.fn.hasAttr=function(t){if(this.attr)var e=this.attr(t);else e=this.getAttribute(t);return void 0!==e&&!1!==e&&null!==e},t.fn.isFormTag=function(e){var a;if((a=isNaN(e)?t(this):t(e)).length){var n=a.prop("tagName").toLowerCase().trim();return-1!=t.inArray(n,["input","select","button","label"])}return!1},t.fn.isAnchorTag=function(e){var a;if((a=isNaN(e)?t(this):t(e)).length){var n=a.prop("tagName").toLowerCase().trim();return-1!=t.inArray(n,["a"])}return!1},t.fn.isHtmlTag=function(e){var a;if((a=isNaN(e)?t(this):t(e)).length){var n=a.prop("tagName").toLowerCase().trim();return-1!=t.inArray(n,["span","div"])}return!1},String.prototype.indexesOf=function(t){for(var e=[],a=0;a<this.length;a++)this[a]===t.trim()&&e.push(a);return e};var a={main:"",table:"<table></table>",head:"<thead></thead>",body:"<tbody></tbody>",foot:"<tfoot></tfoot>",tr:"<tr></tr>",th:"<th></th>",td:"<td></td>"},n=function(e){return t.extend({dbcols:[],column:[],data:{},class:"table table-responsive table-bordered",id:"tableGrid",rowmerge:!1,autocolumn:!0,onrowbound:function(t,e){},onrowbound:function(t){}},e)}}(jQuery);